<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Economic Anxiety vs Cultural Identity: American Voting Patterns</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        // Wait for Chart.js to load and test it
        window.addEventListener('load', function() {
            console.log('Page fully loaded');
            console.log('Chart.js available:', typeof Chart !== 'undefined');
            if (typeof Chart !== 'undefined') {
                console.log('Chart.js version:', Chart.version);
            }
        });

        // Define showTab function immediately
        function showTab(tabName) {
            console.log('=== showTab called with:', tabName, '===');
            
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            console.log('Found tab contents:', tabContents.length);
            tabContents.forEach((tab, index) => {
                console.log(`Tab ${index}:`, tab.id, 'active:', tab.classList.contains('active'));
                if (tab) tab.classList.remove('active');
            });

            // Remove active class from all buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                if (button) button.classList.remove('active');
            });

            // Show selected tab
            const targetTab = document.getElementById(tabName);
            console.log('Target tab element:', targetTab);
            if (targetTab) {
                targetTab.classList.add('active');
                console.log('Activated tab:', tabName);
                
                // Check if canvas elements exist in this tab
                const canvases = targetTab.querySelectorAll('canvas');
                console.log('Canvases in tab:', canvases.length);
                canvases.forEach((canvas, index) => {
                    console.log(`Canvas ${index}:`, canvas.id, 'width:', canvas.width, 'height:', canvas.height);
                });
            } else {
                console.error('Tab element not found for:', tabName);
                return;
            }
            
            // Find and activate the correct button
            const allButtons = document.querySelectorAll('.tab-button');
            allButtons.forEach(button => {
                if (button.onclick && button.onclick.toString().includes(`'${tabName}'`)) {
                    button.classList.add('active');
                    console.log('Activated button for:', tabName);
                }
            });

            // Wait longer and check Chart.js availability
            setTimeout(() => {
                console.log('=== Starting chart initialization ===');
                console.log('Chart.js available:', typeof Chart !== 'undefined');
                console.log('Charts object exists:', typeof charts !== 'undefined');
                
                if (typeof Chart !== 'undefined') {
                    console.log('Chart.js version:', Chart.version || 'unknown');
                    initializeChartsForTab(tabName);
                } else {
                    console.error('Chart.js is not available!');
                    // Try to show a simple message in the chart container
                    const targetTab = document.getElementById(tabName);
                    if (targetTab) {
                        const chartContainers = targetTab.querySelectorAll('.chart-wrapper');
                        chartContainers.forEach(container => {
                            container.innerHTML = '<p style="text-align: center; padding: 50px; color: red;">Chart.js failed to load</p>';
                        });
                    }
                }
            }, 1000);
        }
        
        // Test function availability
        console.log('showTab function defined');

        // Initialize charts object
        let charts = {};
        console.log('Charts object initialized');

        // Chart data definitions
        const distressedCountiesData = {
            labels: ['Prosperous', 'Comfortable', 'Mid-tier', 'At Risk', 'Distressed'],
            datasets: [{
                label: 'Trump 2024 Shift (%)',
                data: [-2.1, 1.3, 4.7, 8.9, 14.1],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2
            }, {
                label: 'Poverty Rate (%)',
                data: [8.5, 11.2, 14.8, 18.9, 23.7],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2
            }]
        };

        const manufacturingData = {
            datasets: [{
                label: 'Rust Belt',
                data: [
                    {x: -33.2, y: 8.1}, {x: -28.7, y: 9.5}, {x: -25.4, y: 6.2}, 
                    {x: -21.8, y: 7.8}, {x: -19.3, y: 4.9}
                ],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                pointRadius: 8
            }, {
                label: 'South',
                data: [
                    {x: -45.1, y: 3.8}, {x: -23.9, y: 2.1}, {x: -18.2, y: 2.8}
                ],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                pointRadius: 8
            }]
        };

        const casesData = {
            labels: ['Elliott County, KY', 'Mahoning County, OH', 'Monroe County, MI', 'Maverick County, TX'],
            datasets: [{
                label: 'Political Swing (Points)',
                data: [48, 26, 16, 14],
                backgroundColor: [
                    'rgba(255, 124, 124, 0.8)',
                    'rgba(136, 132, 216, 0.8)',
                    'rgba(255, 196, 88, 0.8)',
                    'rgba(130, 202, 157, 0.8)'
                ],
                borderColor: [
                    'rgba(255, 124, 124, 1)',
                    'rgba(136, 132, 216, 1)',
                    'rgba(255, 196, 88, 1)',
                    'rgba(130, 202, 157, 1)'
                ],
                borderWidth: 2
            }]
        };

        const policyData = {
            labels: ['Healthcare\n(ACA/Medicaid)', 'Tax Cuts\nfor Wealthy', 'Trade\nTariffs', 'School\nVouchers'],
            datasets: [{
                label: 'General Public Support (%)',
                data: [68, 21, 35, 42],
                backgroundColor: 'rgba(130, 202, 157, 0.8)',
                borderColor: 'rgba(130, 202, 157, 1)',
                borderWidth: 2
            }, {
                label: 'Votes Against Self-Interest (%)',
                data: [72, 58, 71, 65],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2
            }]
        };

        const messagingData = {
            labels: ['Pure Economic\nPolicy', 'Cultural\nValues', 'Economic +\nCultural', 'Immigration +\nEconomy', 'National\nIdentity'],
            datasets: [{
                label: 'Social Media Engagement (%)',
                data: [2.1, 8.4, 6.7, 9.2, 7.8],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2
            }, {
                label: 'Political Effectiveness (%)',
                data: [25, 78, 82, 85, 79],
                backgroundColor: 'rgba(130, 202, 157, 0.8)',
                borderColor: 'rgba(130, 202, 157, 1)',
                borderWidth: 2
            }]
        };

        const prioritiesData = {
            labels: ['Economy', 'Immigration', 'Crime', 'Cultural Values', 'Healthcare', 'Education'],
            datasets: [{
                label: 'Trump Voters (%)',
                data: [93, 82, 76, 71, 45, 38],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2
            }, {
                label: 'All Voters (%)',
                data: [81, 45, 38, 34, 67, 58],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2
            }]
        };

        // Chart initialization function
        function initializeChartsForTab(tabName) {
            console.log('Initializing charts for tab:', tabName);
            console.log('Charts object before:', Object.keys(charts));
            
            // Create real charts with actual data
            if (tabName === 'economic') {
                console.log('Creating economic charts...');
                
                // Distress Chart
                if (!charts.distressChart) {
                    const canvas = document.getElementById('distressChart');
                    if (canvas) {
                        console.log('Creating distress chart');
                        const ctx = canvas.getContext('2d');
                        charts.distressChart = new Chart(ctx, {
                            type: 'bar',
                            data: distressedCountiesData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Economic Distress vs Republican Voting'
                                    },
                                    legend: {
                                        display: true
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Percentage'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Distress chart created successfully');
                    }
                }

                // Manufacturing Chart
                if (!charts.manufacturingChart) {
                    const canvas = document.getElementById('manufacturingChart');
                    if (canvas) {
                        console.log('Creating manufacturing chart');
                        const ctx = canvas.getContext('2d');
                        charts.manufacturingChart = new Chart(ctx, {
                            type: 'scatter',
                            data: manufacturingData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Manufacturing Job Losses vs Political Shifts'
                                    },
                                    legend: {
                                        display: true
                                    }
                                },
                                scales: {
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Manufacturing Jobs Lost (%)'
                                        }
                                    },
                                    y: {
                                        title: {
                                            display: true,
                                            text: 'Trump Vote Shift 2016 (%)'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Manufacturing chart created successfully');
                    }
                }
                
            } else if (tabName === 'regional') {
                console.log('Creating regional charts...');
                
                if (!charts.casesChart) {
                    const canvas = document.getElementById('casesChart');
                    if (canvas) {
                        console.log('Creating cases chart');
                        const ctx = canvas.getContext('2d');
                        charts.casesChart = new Chart(ctx, {
                            type: 'bar',
                            data: casesData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'County Case Studies: Political Swings'
                                    },
                                    legend: {
                                        display: false
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Political Swing (Points)'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Cases chart created successfully');
                    }
                }
                
            } else if (tabName === 'policy') {
                console.log('Creating policy charts...');
                
                if (!charts.policyChart) {
                    const canvas = document.getElementById('policyChart');
                    if (canvas) {
                        console.log('Creating policy chart');
                        const ctx = canvas.getContext('2d');
                        charts.policyChart = new Chart(ctx, {
                            type: 'bar',
                            data: policyData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Policy Support vs Voting Behavior'
                                    },
                                    legend: {
                                        display: true
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Percentage (%)'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Policy chart created successfully');
                    }
                }
                
            } else if (tabName === 'messaging') {
                console.log('Creating messaging charts...');
                
                if (!charts.messagingChart) {
                    const canvas = document.getElementById('messagingChart');
                    if (canvas) {
                        console.log('Creating messaging chart');
                        const ctx = canvas.getContext('2d');
                        charts.messagingChart = new Chart(ctx, {
                            type: 'bar',
                            data: messagingData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Cultural vs Economic Messaging Effectiveness'
                                    },
                                    legend: {
                                        display: true
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Percentage'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Messaging chart created successfully');
                    }
                }

                if (!charts.prioritiesChart) {
                    const canvas = document.getElementById('prioritiesChart');
                    if (canvas) {
                        console.log('Creating priorities chart');
                        const ctx = canvas.getContext('2d');
                        charts.prioritiesChart = new Chart(ctx, {
                            type: 'bar',
                            data: prioritiesData,
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    title: {
                                        display: true,
                                        text: 'Voter Priorities: Trump Supporters vs All Voters'
                                    },
                                    legend: {
                                        display: true
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Importance (%)'
                                        }
                                    }
                                }
                            }
                        });
                        console.log('Priorities chart created successfully');
                    }
                }
            }
            
            console.log('Chart initialization complete for:', tabName);
            console.log('Charts object after:', Object.keys(charts));
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: white;
            border-radius: 10px;
            padding: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .tab-button {
            padding: 12px 24px;
            margin: 0 2px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #666;
            user-select: none;
        }

        .tab-button.active {
            background: #667eea !important;
            color: white !important;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .tab-button:hover:not(.active) {
            background: #f0f0f0;
            color: #333;
        }

        .tab-button:active {
            transform: translateY(1px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-bottom: 15px;
        }

        .chart-description {
            font-size: 0.9rem;
            color: #666;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .stat-description {
            color: #666;
            font-size: 0.9rem;
        }

        .case-studies {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .case-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #ff7c7c;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
        }

        .case-card h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .case-card p {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .transformation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .transformation-card {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .transformation-card.blue {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 2px solid #2196f3;
        }

        .transformation-card.red {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border: 2px solid #f44336;
        }

        .transformation-card.gray {
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            border: 2px solid #9e9e9e;
        }

        .transformation-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .findings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }

        .findings-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .findings-section h4 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid;
        }

        .findings-section.economic h4 {
            color: #2196f3;
            border-color: #2196f3;
        }

        .findings-section.cultural h4 {
            color: #f44336;
            border-color: #f44336;
        }

        .findings-section ul {
            list-style: none;
        }

        .findings-section li {
            padding: 8px 0;
            font-size: 0.9rem;
            border-bottom: 1px solid #eee;
        }

        .findings-section li:last-child {
            border-bottom: none;
        }

        .theory-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
        }

        .theory-item {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid;
        }

        .theory-item.blue {
            background: #e3f2fd;
            border-color: #2196f3;
        }

        .theory-item.green {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .theory-item.purple {
            background: #f3e5f5;
            border-color: #9c27b0;
        }

        .theory-item h4 {
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .theory-item p {
            color: #666;
            font-size: 0.9rem;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.8rem;
            background: white;
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab-button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Economic Anxiety vs Cultural Identity</h1>
            <p>Interactive analysis of why economically struggling communities vote against their apparent economic interests</p>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="console.log('Summary clicked'); showTab('summary')">Summary</button>
            <button class="tab-button" onclick="console.log('Economic clicked'); showTab('economic')">Economic Data</button>
            <button class="tab-button" onclick="console.log('Regional clicked'); showTab('regional')">Regional Cases</button>
            <button class="tab-button" onclick="console.log('Policy clicked'); showTab('policy')">Policy Contradictions</button>
            <button class="tab-button" onclick="console.log('Messaging clicked'); showTab('messaging')">Cultural Messaging</button>
        </div>

        <!-- Summary Tab -->
        <div id="summary" class="tab-content active">
            <div style="background: linear-gradient(135deg, #e3f2fd, #ffebee); padding: 30px; border-radius: 15px; text-align: center; margin-bottom: 30px;">
                <h3 style="font-size: 2rem; margin-bottom: 15px; color: #333;">The American Voting Paradox</h3>
                <p style="font-size: 1.1rem; color: #555; max-width: 800px; margin: 0 auto;">
                    Economically struggling communities consistently vote for policies that may harm their economic interests, 
                    driven by cultural identity considerations that override rational economic calculations.
                </p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" style="color: #f44336;">97%</div>
                    <div class="stat-description">of the 100 poorest counties are in Republican states</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" style="color: #2196f3;">+14.1%</div>
                    <div class="stat-description">average swing toward Trump in most distressed counties</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" style="color: #4caf50;">3.5x</div>
                    <div class="stat-description">cultural anxiety is stronger predictor than economic distress</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" style="color: #9c27b0;">5.5M</div>
                    <div class="stat-description">manufacturing jobs lost (2000-2017) in areas that shifted Republican</div>
                </div>
            </div>

            <div class="findings-grid">
                <div class="findings-section economic">
                    <h4>Economic Patterns</h4>
                    <ul>
                        <li>• Highest distress counties show largest Republican swings</li>
                        <li>• Manufacturing job losses correlate with conservative voting</li>
                        <li>• Trade war policies hurt the communities that supported them</li>
                        <li>• Tax cuts primarily benefit wealthy while harming working families</li>
                    </ul>
                </div>
                <div class="findings-section cultural">
                    <h4>Cultural Drivers</h4>
                    <ul>
                        <li>• Cultural messaging outperforms economic appeals 4:1</li>
                        <li>• Identity-based content achieves higher viral rates</li>
                        <li>• Status threat more powerful than economic threat</li>
                        <li>• Group loyalty overrides individual economic interest</li>
                    </ul>
                </div>
            </div>

            <div class="theory-section">
                <h3 style="margin-bottom: 20px;">Theoretical Framework</h3>
                <div class="theory-item blue">
                    <h4>System Justification Theory</h4>
                    <p>People defend existing systems even when disadvantaged, driven by needs for certainty, security, and social acceptance.</p>
                </div>
                <div class="theory-item green">
                    <h4>Social Identity Theory</h4>
                    <p>Group membership and cultural identity often override individual economic calculations in political decision-making.</p>
                </div>
                <div class="theory-item purple">
                    <h4>Motivated Reasoning</h4>
                    <p>Voters engage emotion-based reasoning that supports group identity rather than analytical thinking about economic interests.</p>
                </div>
            </div>
        </div>

        <!-- Economic Data Tab -->
        <div id="economic" class="tab-content">
            <div class="chart-container">
                <h3>Economic Distress vs Republican Voting (2024)</h3>
                <div class="chart-wrapper">
                    <canvas id="distressChart"></canvas>
                </div>
                <div class="chart-description">
                    <strong>Key Finding:</strong> Counties with highest economic distress show largest shifts toward Trump (+14.1%), 
                    despite policies that may not address their economic challenges.
                </div>
            </div>

            <div class="chart-container">
                <h3>Manufacturing Job Losses vs Political Shifts</h3>
                <div class="chart-wrapper">
                    <canvas id="manufacturingChart"></canvas>
                </div>
                <div class="chart-description">
                    <strong>Paradox:</strong> States with greater manufacturing job losses showed larger swings toward policies 
                    that economists predict will not restore manufacturing employment.
                </div>
            </div>
        </div>

        <!-- Regional Cases Tab -->
        <div id="regional" class="tab-content">
            <div class="chart-container">
                <h3>County Case Studies: Economic Distress vs Political Swings</h3>
                <div class="chart-wrapper">
                    <canvas id="casesChart"></canvas>
                </div>
                <div class="case-studies">
                    <div class="case-card">
                        <h4>Elliott County, KY</h4>
                        <p>Poorest county, massive swing</p>
                        <p><strong>Poverty Rate:</strong> 32.1%</p>
                        <p><strong>Political Swing:</strong> 48 points</p>
                    </div>
                    <div class="case-card">
                        <h4>Mahoning County, OH</h4>
                        <p>Youngstown - lost 40k steel jobs</p>
                        <p><strong>Poverty Rate:</strong> 19.8%</p>
                        <p><strong>Political Swing:</strong> 26 points</p>
                    </div>
                    <div class="case-card">
                        <h4>Monroe County, MI</h4>
                        <p>Auto industry struggles</p>
                        <p><strong>Poverty Rate:</strong> 12.3%</p>
                        <p><strong>Political Swing:</strong> 16 points</p>
                    </div>
                    <div class="case-card">
                        <h4>Maverick County, TX</h4>
                        <p>95% Hispanic, biggest 2024 swing</p>
                        <p><strong>Poverty Rate:</strong> 28.7%</p>
                        <p><strong>Political Swing:</strong> 14 points</p>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3>West Virginia Transformation</h3>
                <div class="transformation-grid">
                    <div class="transformation-card blue">
                        <h4>1996</h4>
                        <div class="transformation-number">+15%</div>
                        <p>Clinton margin over Dole<br/>Higher than California</p>
                    </div>
                    <div class="transformation-card red">
                        <h4>2024</h4>
                        <div class="transformation-number">+42%</div>
                        <p>Trump margin<br/>2nd best performing state</p>
                    </div>
                    <div class="transformation-card gray">
                        <h4>Economic Reality</h4>
                        <div class="transformation-number">-78%</div>
                        <p>Coal jobs lost since 1970s<br/>Population declining 6 years</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Policy Contradictions Tab -->
        <div id="policy" class="tab-content">
            <div class="chart-container">
                <h3>Policy Support vs Voting Behavior Contradictions</h3>
                <div class="chart-wrapper">
                    <canvas id="policyChart"></canvas>
                </div>
                <div class="chart-description">
                    <strong>Contradiction:</strong> High general support for policies that would help economically struggling communities, 
                    but consistent voting for representatives who oppose these policies.
                </div>
            </div>

            <div class="chart-container">
                <h3>Kentucky Healthcare Paradox</h3>
                <div class="findings-grid">
                    <div class="findings-section economic">
                        <h4>ACA Benefits in Kentucky</h4>
                        <ul>
                            <li>• <strong>475,000</strong> gained coverage</li>
                            <li>• Uninsured rate: <strong>19% → 7%</strong></li>
                            <li>• Drug treatment up <strong>740%</strong></li>
                            <li>• Billions in federal funding</li>
                            <li>• Better than national average</li>
                        </ul>
                    </div>
                    <div class="findings-section cultural">
                        <h4>Voting Behavior</h4>
                        <ul>
                            <li>• Reelected Mitch McConnell</li>
                            <li>• Elected Bevin (anti-ACA)</li>
                            <li>• Supported ACA repeal efforts</li>
                            <li>• Voted against healthcare expansion</li>
                            <li>• Maintained opposition despite benefits</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cultural Messaging Tab -->
        <div id="messaging" class="tab-content">
            <div class="chart-container">
                <h3>Cultural vs Economic Messaging Effectiveness</h3>
                <div class="chart-wrapper">
                    <canvas id="messagingChart"></canvas>
                </div>
                <div class="chart-description">
                    <strong>Key Insight:</strong> Cultural messaging and identity-based appeals significantly outperform 
                    pure economic policy discussions in both engagement and political effectiveness.
                </div>
            </div>

            <div class="chart-container">
                <h3>Voter Priorities: Trump Supporters vs All Voters</h3>
                <div class="chart-wrapper">
                    <canvas id="prioritiesChart"></canvas>
                </div>
                <div class="chart-description">
                    <strong>Pattern:</strong> While economy ranks high for all voters, Trump supporters prioritize 
                    cultural issues (immigration, crime, values) much more than general population.
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Data sources: Economic Innovation Group, Bureau of Labor Statistics, American National Election Studies, Pew Research, Academic Studies</p>
        </div>
    </div>

    <script>
    <script>
        // Chart data
        const distressedCountiesData = {
            labels: ['Prosperous', 'Comfortable', 'Mid-tier', 'At Risk', 'Distressed'],
            datasets: [{
                label: 'Trump 2024 Shift (%)',
                data: [-2.1, 1.3, 4.7, 8.9, 14.1],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2,
                yAxisID: 'y'
            }, {
                label: 'Poverty Rate (%)',
                data: [8.5, 11.2, 14.8, 18.9, 23.7],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2,
                yAxisID: 'y1'
            }]
        };

        const manufacturingData = {
            datasets: [{
                label: 'Rust Belt',
                data: [
                    {x: -33.2, y: 8.1}, {x: -28.7, y: 9.5}, {x: -25.4, y: 6.2}, 
                    {x: -21.8, y: 7.8}, {x: -19.3, y: 4.9}
                ],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                pointRadius: 8
            }, {
                label: 'South',
                data: [
                    {x: -45.1, y: 3.8}, {x: -23.9, y: 2.1}, {x: -18.2, y: 2.8}
                ],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                pointRadius: 8
            }]
        };

        const casesData = {
            labels: ['Elliott County, KY', 'Mahoning County, OH', 'Monroe County, MI', 'Maverick County, TX'],
            datasets: [{
                label: 'Political Swing (Points)',
                data: [48, 26, 16, 14],
                backgroundColor: [
                    'rgba(255, 124, 124, 0.8)',
                    'rgba(136, 132, 216, 0.8)',
                    'rgba(255, 196, 88, 0.8)',
                    'rgba(130, 202, 157, 0.8)'
                ],
                borderColor: [
                    'rgba(255, 124, 124, 1)',
                    'rgba(136, 132, 216, 1)',
                    'rgba(255, 196, 88, 1)',
                    'rgba(130, 202, 157, 1)'
                ],
                borderWidth: 2
            }]
        };

        const policyData = {
            labels: ['Healthcare\n(ACA/Medicaid)', 'Tax Cuts\nfor Wealthy', 'Trade\nTariffs', 'School\nVouchers'],
            datasets: [{
                label: 'General Public Support (%)',
                data: [68, 21, 35, 42],
                backgroundColor: 'rgba(130, 202, 157, 0.8)',
                borderColor: 'rgba(130, 202, 157, 1)',
                borderWidth: 2
            }, {
                label: 'Votes Against Self-Interest (%)',
                data: [72, 58, 71, 65],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2
            }]
        };

        const messagingData = {
            labels: ['Pure Economic\nPolicy', 'Cultural\nValues', 'Economic +\nCultural', 'Immigration +\nEconomy', 'National\nIdentity'],
            datasets: [{
                label: 'Social Media Engagement (%)',
                data: [2.1, 8.4, 6.7, 9.2, 7.8],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2,
                yAxisID: 'y'
            }, {
                label: 'Political Effectiveness (%)',
                data: [25, 78, 82, 85, 79],
                backgroundColor: 'rgba(130, 202, 157, 0.8)',
                borderColor: 'rgba(130, 202, 157, 1)',
                borderWidth: 2,
                yAxisID: 'y1'
            }]
        };

        const prioritiesData = {
            labels: ['Economy', 'Immigration', 'Crime', 'Cultural Values', 'Healthcare', 'Education'],
            datasets: [{
                label: 'Trump Voters (%)',
                data: [93, 82, 76, 71, 45, 38],
                backgroundColor: 'rgba(255, 124, 124, 0.8)',
                borderColor: 'rgba(255, 124, 124, 1)',
                borderWidth: 2
            }, {
                label: 'All Voters (%)',
                data: [81, 45, 38, 34, 67, 58],
                backgroundColor: 'rgba(136, 132, 216, 0.8)',
                borderColor: 'rgba(136, 132, 216, 1)',
                borderWidth: 2
            }]
        };

        let charts = {};

        function initializeChartsForTab(tabName) {
            if (tabName === 'economic') {
                if (!charts.distressChart) {
                    const ctx1 = document.getElementById('distressChart').getContext('2d');
                    charts.distressChart = new Chart(ctx1, {
                        type: 'bar',
                        data: distressedCountiesData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Percentage (%)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                        }
                    });
                }
            } else if (tabName === 'messaging') {
                if (!charts.messagingChart) {
                    const ctx5 = document.getElementById('messagingChart').getContext('2d');
                    charts.messagingChart = new Chart(ctx5, {
                        type: 'bar',
                        data: messagingData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'Social Media Engagement (%)'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Political Effectiveness (%)'
                                    },
                                    grid: {
                                        drawOnChartArea: false,
                                    },
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                        }
                    });
                }

                if (!charts.prioritiesChart) {
                    const ctx6 = document.getElementById('prioritiesChart').getContext('2d');
                    charts.prioritiesChart = new Chart(ctx6, {
                        type: 'bar',
                        data: prioritiesData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Importance (%)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                        }
                    });
                }
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            
            // Test basic functionality
            console.log('Testing selectors...');
            console.log('Tab contents found:', document.querySelectorAll('.tab-content').length);
            console.log('Tab buttons found:', document.querySelectorAll('.tab-button').length);
            
            // Add event listeners to tab buttons (as backup to onclick)
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach((button, index) => {
                console.log(`Setting up button ${index}:`, button.getAttribute('data-tab'));
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tabName = this.getAttribute('data-tab');
                    console.log('Event listener triggered for:', tabName);
                    window.showTab(tabName);
                });
            });
            
            // Initialize default view
            console.log('Initializing default view...');
            initializeChartsForTab('summary');
            
            // Test the showTab function directly
            console.log('Testing showTab function...');
            if (typeof window.showTab === 'function') {
                console.log('showTab function is available');
            } else {
                console.error('showTab function is NOT available');
            }
        });
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'Trump 2024 Shift (%)'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Poverty Rate (%)'
                                    },
                                    grid: {
                                        drawOnChartArea: false,
                                    },
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                        }
                    });
                }

                if (!charts.manufacturingChart) {
                    const ctx2 = document.getElementById('manufacturingChart').getContext('2d');
                    charts.manufacturingChart = new Chart(ctx2, {
                        type: 'scatter',
                        data: manufacturingData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Manufacturing Jobs Lost (%)'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Trump Vote Shift 2016 (%)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true
                                }
                            }
                        }
                    });
                }
            } else if (tabName === 'regional') {
                if (!charts.casesChart) {
                    const ctx3 = document.getElementById('casesChart').getContext('2d');
                    charts.casesChart = new Chart(ctx3, {
                        type: 'bar',
                        data: casesData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    title: {
                                        display: true,
                                        text: 'Political Swing (Percentage Points)'
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                }
            } else if (tabName === 'policy') {
                if (!charts.policyChart) {
                    const ctx4 = document.getElementById('policyChart').getContext('2d');
                    charts.policyChart = new Chart(ctx4, {
                        type: 'bar',
                        data: policyData,
                        options: {